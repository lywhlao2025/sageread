# SageRead 简约模式（启动弹窗引导）需求&技术文档

## 背景与目标
- 背景：当前设置门槛较高，普通用户（对大模型不熟悉）难以快速体验“翻译/对话”的核心价值。
- 目标：以“效率提升”为价值主张，降低首次使用成本，提升用户使用量与活跃。
- 短期目标（1-2 个月）：扩大量级（D1/D3 使用量、7 日内有效使用次数）。

## 目标人群
- 普通用户：希望“打开即用、少配置”，主要场景为翻译/对话。

## 核心 KPI（以使用量为核心）
- 新用户 7 日内有效使用次数（完成一次翻译/对话输出）。
- 首日激活率（24h 内完成首次翻译/对话）。
- 首次任务完成时长（打开文档到首次翻译/对话输出）。
- D1/D3 复访率。
- 功能阻断率（设置/模型问题导致失败）。

## 需求范围
### 必须做
- 启动时弹窗引导：选择“简约模式/经典模式”。
- 简约模式：隐藏复杂设置，保留核心阅读 + 翻译/对话入口。
- 模式切换入口：简约模式可切换经典模式，经典模式可切换简约模式。
- 埋点（第三方）：覆盖模式选择、首次任务、任务使用量、切换行为。

### 暂不做
- 深度商业化（定价/额度数值）先不固化，仅预留展示与计量能力。
- 多支付渠道接入（后续单独评估）。

## 关键流程（用户视角）
1. 首次启动弹窗出现 → 选择“简约模式/经典模式”。
2. 简约模式下：可直接翻译/对话 → 获得结果 → 轻提示“剩余额度/可升级”。
3. 需要高级设置时可切换到经典模式。

## 交互与文案建议
- 弹窗标题：选择使用方式
- 简约模式：快速开始，自动配置（推荐）
- 经典模式：高级设置与更多控制
- 提示语：可随时在设置中切换

## 信息架构与 UI 改动点（高层）
- 首次启动弹窗：App 启动阶段展示（前端）。
- 简约模式：
  - 默认隐藏左侧栏（仅保留阅读区 + 关键操作）。
  - 翻译/对话入口突出显示。
  - 设置入口保留“切换模式”按钮。
- 经典模式：保持现有体验，不破坏既有功能。

## 埋点与数据闭环（第三方）
### 事件列表（最小可行）
- `mode_selected`
  - props: `mode`(simple|classic), `source`(onboarding|settings)
- `first_task_done`
  - props: `task_type`(translate|chat), `duration_ms`, `doc_type`
- `task_done`
  - props: `task_type`, `duration_ms`, `doc_type`, `success`
- `switch_mode`
  - props: `from`, `to`, `source`
- `task_failed`
  - props: `task_type`, `error_type`(model|network|config|unknown)

### 第三方埋点方案
- 选型：Amplitude
- 选择原则：SDK 体积、Tauri 兼容性、事件查询能力、成本。

### Amplitude 接入细化（提纲）
#### SDK 与初始化
- SDK：Amplitude Browser SDK（前端集成，Tauri 容器内运行）
- 初始化时机：App 启动后、首屏渲染前完成初始化
- 配置项：
  - `apiKey`：从环境变量注入（避免硬编码）
  - `defaultTracking`: 仅保留必要项（如 `pageViews=false`，避免噪声）
  - `minIdLength` 与 `storage`：兼容本地存储策略

#### 用户标识与匿名策略
- `device_id`：首次启动生成并持久化（本地存储）
- `user_id`：登录态/付费态出现时写入，否则保持匿名
- 规则：匿名用户仍可完整埋点；登录后进行用户合并（identify）

#### 事件命名与公共属性
- 事件命名：动词过去式风格（`mode_selected`, `task_done`）
- 公共属性（每个事件自动附带）：
  - `app_version`
  - `os` / `platform`
  - `lang`
  - `mode`（simple|classic）
  - `doc_type`（pdf|epub|txt|unknown）
  - `network`（online|offline）

#### 可靠性与失败处理
- 失败重试：SDK 自带队列；离线缓存并在恢复后发送
- 本地降级：埋点失败不阻断主流程，不影响翻译/对话

#### 隐私与合规（最小化）
- 不采集：原文内容、用户隐私文本、敏感标识
- 仅采集：行为事件与必要上下文

#### 事件对照表（补充字段）
- `mode_selected`
  - props: `mode`, `source`
- `first_task_done`
  - props: `task_type`, `duration_ms`, `doc_type`
- `task_done`
  - props: `task_type`, `duration_ms`, `doc_type`, `success`
- `switch_mode`
  - props: `from`, `to`, `source`
- `task_failed`
  - props: `task_type`, `error_type`

## 商业化策略（预留）
- 免费额度 + 订阅为主，按量仅作超额补充。
- UI 仅展示“剩余额度/升级入口”，不展示复杂模型信息。
- 额度数值暂定，后续通过 A/B 调整。

## 技术方案（高层）
### 前端（packages/app/src）
- 新增“模式选择弹窗”组件与首次启动逻辑。
- 在 `store/` 增加模式状态（simple|classic），持久化存储。
- 简约模式下：
  - UI 布局切换（隐藏侧边栏/非核心面板）。
  - 仅保留核心操作入口。
- 新增埋点服务层（`services/` 或 `lib/`），统一上报逻辑。
- 事件触发点：翻译/对话成功与失败、切换模式、首次选择等。

### 后端（Tauri / Rust）
- 暂不新增命令；如需本地持久化埋点缓存，再评估。

## 依赖与前置条件
- 选择并接入第三方埋点服务（需要 SDK/接口确认）。
- i18n 文案补全（中/英等既有语言）。
- 模式状态本地存储（兼容已有设置结构）。

## 风险与应对
- 风险：简约模式隐藏过多导致核心操作不可达。
  - 应对：保持翻译/对话入口高可见。
- 风险：埋点不完整导致无法评估效果。
  - 应对：先上线最小事件集，强制关键路径上报。
- 风险：商业化提示过强影响扩量。
  - 应对：仅轻提示与软入口，不强阻断。

## 验收标准
- 首次启动弹窗稳定出现；可选简约/经典模式。
- 简约模式可直接翻译/对话并产出结果。
- 模式切换入口存在且生效。
- 关键埋点事件在本地/第三方可查询。
- 不影响既有经典模式功能与数据。

## 版本与里程碑（建议）
- M1：弹窗引导 + 模式状态持久化 + UI 切换
- M2：埋点全链路 + 首次任务指标
- M3：轻度商业化展示（额度提示/升级入口）
